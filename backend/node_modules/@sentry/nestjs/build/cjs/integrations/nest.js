Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });

const instrumentationNestjsCore = require('@opentelemetry/instrumentation-nestjs-core');
const core = require('@sentry/core');
const Sentry = require('@sentry/node');
const sentryNestEventInstrumentation = require('./sentry-nest-event-instrumentation.js');
const sentryNestInstrumentation = require('./sentry-nest-instrumentation.js');

const INTEGRATION_NAME = 'Nest';

const instrumentNestCore = Sentry.generateInstrumentOnce(`${INTEGRATION_NAME}.Core`, () => {
  return new instrumentationNestjsCore.NestInstrumentation();
});

const instrumentNestCommon = Sentry.generateInstrumentOnce(`${INTEGRATION_NAME}.Common`, () => {
  return new sentryNestInstrumentation.SentryNestInstrumentation();
});

const instrumentNestEvent = Sentry.generateInstrumentOnce(`${INTEGRATION_NAME}.Event`, () => {
  return new sentryNestEventInstrumentation.SentryNestEventInstrumentation();
});

const instrumentNest = Object.assign(
  () => {
    instrumentNestCore();
    instrumentNestCommon();
    instrumentNestEvent();
  },
  { id: INTEGRATION_NAME },
);

/**
 * Integration capturing tracing data for NestJS.
 */
const nestIntegration = core.defineIntegration(() => {
  return {
    name: INTEGRATION_NAME,
    setupOnce() {
      instrumentNest();
    },
  };
});

exports.instrumentNest = instrumentNest;
exports.nestIntegration = nestIntegration;
//# sourceMappingURL=nest.js.map
